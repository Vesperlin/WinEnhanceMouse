# WinEnhanceMouse - Windows 11 增强鼠标自定义插件


## **I. 项目概述与架构**

| 方面 | 描述 |
|---|---|
| 目标 | 为 Windows 11 提供高度定制化、多层次、AI 驱动的鼠标中键菜单及按键宏功能。 |
| 平台 | 专为 Windows 11 系统设计与优化。 |
| 核心技术 | 采用底层 Windows Hooking / API 实现全局按键监听与系统控制；使用 GUI 框架（如 WPF/.NET）构建设置界面；通过 JSON 文件管理配置和实现导入导出；集成 AI SDK 进行智能辅助。 |
| 关键特性 | 多模式配置、分层操作队列（一层/二层）、非侵入式中键菜单、高权限 AI 助理。 |



## **II. 核心交互系统：中键菜单 (The Pop-up Menu)**
> 中键菜单是本插件的核心交互界面，通过鼠标中键触发，实现快速操作选择。

### **A. 菜单触发与外观**

| 元素 | 描述 | 交互逻辑 |
|---|---|---|
| 触发键 | 鼠标中键 | 按下中键进入菜单模式；再次按下中键退出菜单（若未选中操作）。 |
| 外观 | 非侵入式弹窗 | 右下角（可配置位置）弹出很小很窄的一条弹窗，无视线遮挡或阻碍。 |
| 导航 | 滚轮滚动 | 上下滚动滚轮选择/聚焦操作，具有类似堆叠滑动的视觉聚焦效果。 |
| 退出菜单 | 单击右键 | 若没有任何操作被选中，单击右键则代表退出菜单模式。 |
| 设置快捷入口 | 后侧键 | 在中键菜单模式下，第一个按下的按键若是后侧键，则直接执行打开程序设置。 |


### **B. 操作选择与分层执行逻辑**
> 操作被分为两层队列，按照选中顺序执行。

| 队列/动作 | 触发按键/方式 | 描述与执行顺序 |
|---|---|---|
| 一层操作队列 | 单击左键 | 单选/多选：无论当前是否多选模式，单击左键将聚焦的操作添加到第一层执行队列中（选中顺序即执行顺序）。 |
| 执行一层 | 前侧键 | 结束多选，并开始执行第一层队列中的所有操作。 |
| 二层操作队列 | 双击左键 | 将当前聚焦操作添加到第二层执行队列中。此操作不影响其在一层菜单中的状态。 |
| 队列执行顺序 | 系统执行 | 第一层操作全部运行完毕后，才会按照选中顺序执行第二层操作。 |
| 取消选择 | 单击右键 | 无论在哪个队列，单击右键取消当前聚焦项的选择。 |
| 状态标识 | 视觉反馈 | 第一层和第二层被选中后标识不同（如不同颜色/图标），且可叠加，用户必须能清楚区分。 |



##  **III. 可配置操作选项清单**
> 可供用户在中键菜单和按键映射中自定义选择的操作（可增添/删减/排序）。


### **A. 浏览器和剪贴板操作 (上下文敏感)**
 * (浏览器) 搜索当前剪贴板内容（在当前标签页）
 * (浏览器) 搜索选中内容（新的标签页）
 * (浏览器) 翻译当前页面为中文 (Google 翻译...)
 * (浏览器) 打开开发者工具 (Google...)
 * (浏览器) 切换上一个标签页
 * (浏览器) 切换下一个标签页
 * (浏览器) 关闭当前标签页 (默认确认...)
 * (浏览器) 新建一个标签页
 * (浏览器) 打开当前浏览器设置
 * (浏览器) 上一页/上一步/回退
 * (浏览器) 下一页/下一步
 * (浏览器) 回到网页最顶端
 * 查看剪贴板历史
 * (文档里) 搜索文字
 * 屏幕区域截图
   
### **B. 窗口与桌面管理**
 * 最小化当前窗口
 * 最大化当前窗口
 * 还原当前窗口
 * 关闭当前窗口
 * 分屏
 * 分屏到下边
 * 分屏到上边
 * 分屏到左边
 * 分屏到右边
 * 切换到上一个窗口 (Alt+Tab)
 * 置顶当前窗口 (再次取消)
 * 显示桌面
 * 打开任务视图 (看所有窗口)
 * 关闭当前桌面
 * 新建桌面
 * 切换到上一个桌面
 * 切换到下一个桌面
   
### **C. 系统控制与多媒体**
 * 刷新
 * 播放/暂停
 * 上一首歌
 * 下一首歌
 * 静音/取消静音
 * 音量 (增大/减小)
 * 锁屏
 * 睡眠
 * 打开任务管理器
 * 重启
 * 关机
   
### **D. 文本编辑与输入**
 * 复制
 * 粘贴
 * 剪切
 * 全选 (文本)
 * 删除 (所选内容)
 * 撤销 (上一步)
 * 重做 (下一步)
 * 回车
 * 向上/向下移动一行
 * 复制整行
 * 删除整行
 * 光标移到行尾
 * 光标移到行首
 * 切换键盘中/英
 * 切换输入法
   
### **D. 应用启动与自定义**
 * 打开浏览器
 * 打开某个网址 (写明网址)
 * 打开某个软件 (写清软件名或安装路径...)
 * 打开截图工具
 * 打开记事本
 * 打开资源管理器
 * (自定义组合)
 * (自定义按键)
 * (可以运行指定具体脚本)
 * (自定义点击某个坐标位置)
 * 方案 1 (预留快捷方案位)
 * 保存
 * 新建文件
 * 打开文件（指定）


 
 
## **IV. 程序设置 UI (GUI) 与配置管理**
> 设置界面是一个独立的应用程序窗口，用于提供用户无代码配置的能力。


| 功能模块 | 描述与要求 |
|---|---|
| 设置窗口 | 采用应用窗口式小窗口设计，有清晰的分类导航（如：模式管理、按键映射、菜单定制、AI 设置、外观设置）。 |
| 配置修改 | 所有操作、按键映射、模式内容等全部可通过 UI 界面进行修改调整，无需手动编辑代码。 |
| 生效机制 | 需有“应用”按钮，点击后所有修改立即生效且自动保存到配置文件。 |
| 模式管理 | 用户可创建/删除/命名模式，并配置每个模式下所有按键的操作。 |
| 配置导入/导出 | 用户可选择“导出当前配置”（自动生成 JSON 文件），或选择“读取配置”文件进行快速切换（支持切换预设）。 |




 
  ## **V. AI 辅助与自动化模块 (AI Mode)**
> AI 模式赋予程序最高的扩展性和智能辅助能力。


| 模块 | 权限与触发 | 详细功能与安全要求 |
|---|---|---|
| 权限等级 | 极高 | AI 拥有查看程序全部代码、查看当前配置界面、实时读取用户屏幕操作内容、以及执行操作的能力。 |
| 触发与状态 | 快捷操作/按键进入/退出。 | AI 模式开启后持续运行。退出时 AI 需保留当前记忆，确保下次开启时记忆连贯。 |
| 初始化设置 | 强制提示 | 第一次点击 AI 模式时，若未在设置中配置 API Key（默认空）、模型、自定义提示词、限制等，则提示进行初始化设置。 |
| 实时指引 | AI 自行发言 | AI 可根据用户的界面操作/动作，在适当时候主动给出简洁、清晰的指引或建议。 |
| 视觉辅助 | 高亮引导 | AI 可以在屏幕上高亮某一特定位置（半透明图层，不影响使用，过一会消失），对用户进行具体操作指引。 |
| 代码/功能自修改 | 文本输入 | 用户可以直接通过文本框要求 AI 编写程序来修改、调整、增加或创新按键功能，AI 生成代码后无需用户任何操作即实现功能修改。 |
| 安全执行 | 用户确认机制 | AI 执行任何高权限操作（如代码修改、系统操作）前，必须弹出一个询问框，用户选择“确认”后方可执行。 |
``
